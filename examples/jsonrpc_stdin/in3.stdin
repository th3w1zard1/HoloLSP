Content-Length: 1814

{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///tmp/nss/k_hen_leadchng.nss","version":0,"languageId":"nss","text":"//:: k_hen_leadchng\n/*\n    Leader Change for the non-active party members.\n*/\n//:: Created By:\n//:: Copyright (c) 2002 Bioware Corp.\n\n#include \"k_inc_debug\"\n#include \"k_inc_generic\"\n\nvoid main()\n{\n    SetCommandable(TRUE, GetPartyMemberByIndex(0));\n    if(!GN_GetSpawnInCondition(SW_FLAG_AI_OFF))\n    {\n        if(GetPartyMemberByIndex(0) != OBJECT_SELF)\n        {\n            if(IsObjectPartyMember(OBJECT_SELF) &&  //Note that this check replaces GetIsObjectValid(oMaster)\n               //GetCurrentAction(OBJECT_SELF) != ACTION_FOLLOW &&\n               //GetCurrentAction(OBJECT_SELF) != ACTION_MOVETOPOINT &&\n               //GetCurrentAction(OBJECT_SELF) != ACTION_WAIT &&\n               GetCurrentAction(OBJECT_SELF) != ACTION_FOLLOWLEADER &&\n               !GetIsConversationActive() &&\n               //GetDistanceBetween(OBJECT_SELF, GetPartyMemberByIndex(0)) > 4.5 &&\n               !GN_GetSpawnInCondition(SW_FLAG_SPECTATOR_STATE) &&\n               GetCommandable())\n            {\n                if( //!GetIsInCombat() &&\n                    !GetIsObjectValid(GetAttackTarget()) &&\n                    !GetIsObjectValid(GetAttemptedAttackTarget()) &&\n                    !GetIsObjectValid(GetAttemptedSpellTarget()) )\n                {\n                    if(!GetSoloMode())\n                    {\n                        //The distance checking is now down in the script fired from AI Action Update - Leave 5m Radius of party leader.\n                        ClearAllActions();\n        \t\t        ActionFollowLeader();\n                    }\n                }\n            }\n        }\n    }\n}\n\n"}}}